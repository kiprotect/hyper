<!DOCTYPE html>
<html lang="de">
<head>
<meta name="generator" content=
"HTML Tidy for HTML5 for Linux version 5.6.0">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content=
"width=device-width, initial-scale=1">
<title>Hyper-Dokumentation | Proxy Service - Sicherheit &
Bedrohungsmodell</title>
<link rel="stylesheet" type="text/css" href=
"/hyper/docs/static/css/main.css">
<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
<script src="/hyper/docs/static/js/mathjax/tex-chtml.js" id=
"MathJax-script" async></script>
<style type="text/css">
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.codehilite .hll { background-color: #ffffcc }
.codehilite { background: #f8f8f8; }
.codehilite .c { color: #8f5902; font-style: italic } /* Comment */
.codehilite .err { color: #a40000; border: 1px solid #ef2929 } /* Error */
.codehilite .g { color: #000000 } /* Generic */
.codehilite .k { color: #204a87; font-weight: bold } /* Keyword */
.codehilite .l { color: #000000 } /* Literal */
.codehilite .n { color: #000000 } /* Name */
.codehilite .o { color: #ce5c00; font-weight: bold } /* Operator */
.codehilite .x { color: #000000 } /* Other */
.codehilite .p { color: #000000; font-weight: bold } /* Punctuation */
.codehilite .ch { color: #8f5902; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #8f5902; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #8f5902; font-style: italic } /* Comment.Preproc */
.codehilite .cpf { color: #8f5902; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #8f5902; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #8f5902; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #a40000 } /* Generic.Deleted */
.codehilite .ge { color: #000000; font-style: italic } /* Generic.Emph */
.codehilite .ges { color: #000000; font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.codehilite .gr { color: #ef2929 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #000000; font-style: italic } /* Generic.Output */
.codehilite .gp { color: #8f5902 } /* Generic.Prompt */
.codehilite .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #a40000; font-weight: bold } /* Generic.Traceback */
.codehilite .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #204a87; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #204a87; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #204a87; font-weight: bold } /* Keyword.Pseudo */
.codehilite .kr { color: #204a87; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #204a87; font-weight: bold } /* Keyword.Type */
.codehilite .ld { color: #000000 } /* Literal.Date */
.codehilite .m { color: #0000cf; font-weight: bold } /* Literal.Number */
.codehilite .s { color: #4e9a06 } /* Literal.String */
.codehilite .na { color: #c4a000 } /* Name.Attribute */
.codehilite .nb { color: #204a87 } /* Name.Builtin */
.codehilite .nc { color: #000000 } /* Name.Class */
.codehilite .no { color: #000000 } /* Name.Constant */
.codehilite .nd { color: #5c35cc; font-weight: bold } /* Name.Decorator */
.codehilite .ni { color: #ce5c00 } /* Name.Entity */
.codehilite .ne { color: #cc0000; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #000000 } /* Name.Function */
.codehilite .nl { color: #f57900 } /* Name.Label */
.codehilite .nn { color: #000000 } /* Name.Namespace */
.codehilite .nx { color: #000000 } /* Name.Other */
.codehilite .py { color: #000000 } /* Name.Property */
.codehilite .nt { color: #204a87; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #000000 } /* Name.Variable */
.codehilite .ow { color: #204a87; font-weight: bold } /* Operator.Word */
.codehilite .pm { color: #000000; font-weight: bold } /* Punctuation.Marker */
.codehilite .w { color: #f8f8f8 } /* Text.Whitespace */
.codehilite .mb { color: #0000cf; font-weight: bold } /* Literal.Number.Bin */
.codehilite .mf { color: #0000cf; font-weight: bold } /* Literal.Number.Float */
.codehilite .mh { color: #0000cf; font-weight: bold } /* Literal.Number.Hex */
.codehilite .mi { color: #0000cf; font-weight: bold } /* Literal.Number.Integer */
.codehilite .mo { color: #0000cf; font-weight: bold } /* Literal.Number.Oct */
.codehilite .sa { color: #4e9a06 } /* Literal.String.Affix */
.codehilite .sb { color: #4e9a06 } /* Literal.String.Backtick */
.codehilite .sc { color: #4e9a06 } /* Literal.String.Char */
.codehilite .dl { color: #4e9a06 } /* Literal.String.Delimiter */
.codehilite .sd { color: #8f5902; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #4e9a06 } /* Literal.String.Double */
.codehilite .se { color: #4e9a06 } /* Literal.String.Escape */
.codehilite .sh { color: #4e9a06 } /* Literal.String.Heredoc */
.codehilite .si { color: #4e9a06 } /* Literal.String.Interpol */
.codehilite .sx { color: #4e9a06 } /* Literal.String.Other */
.codehilite .sr { color: #4e9a06 } /* Literal.String.Regex */
.codehilite .s1 { color: #4e9a06 } /* Literal.String.Single */
.codehilite .ss { color: #4e9a06 } /* Literal.String.Symbol */
.codehilite .bp { color: #3465a4 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #000000 } /* Name.Function.Magic */
.codehilite .vc { color: #000000 } /* Name.Variable.Class */
.codehilite .vg { color: #000000 } /* Name.Variable.Global */
.codehilite .vi { color: #000000 } /* Name.Variable.Instance */
.codehilite .vm { color: #000000 } /* Name.Variable.Magic */
.codehilite .il { color: #0000cf; font-weight: bold } /* Literal.Number.Integer.Long */
</style>
</head>
<body>
<div id="translation-notice">
<div class="message is-info">
<div class="message-body">
<p>Diese Website wurde größtenteils automatisch von der <a href=
"/hyper/docs/proxy-service/security">englischen Version</a>
übersetzt. Wir entschuldigen uns für eventuelle
Übersetzungsfehler.</p>
<span class="x" onclick=
"localStorage.setItem('translation-notice', true);notice.style.display = 'none'">x</span></div>
</div>
</div>
<script>
var notice = document.getElementById("translation-notice")
if (localStorage.getItem("translation-notice") === null && notice !== null){
        notice.style.display = "block"
}
</script>
<nav class="navbar is-dark">
<div class="navbar-brand"><span class="navbar-burger burger"
data-target="side-menu" data-toggle="collapse"><span>&nbsp;</span>
<span>&nbsp;</span> <span>&nbsp;</span></span></div>
</nav>
<div class="main">
<div class="side-menu" id="side-menu" data-toggle-class=
"is-active">
<aside class="menu">
<p class="menu-label" style="text-align:center"><a href=
"/hyper/de/doku">Hyper-Dokumentation</a></p>
<ul class="menu-list">
<li><a href="/hyper/de/doku">Start</a></li>
<li><a href="/hyper/de/doku/getting-started">Erste
Schritte</a></li>
<li><a class="" href="#" data-toggle="collapse" data-target=
"page-hyper-nav">Hyper Service</a>
<ul class="is-hidden" id="page-hyper-nav">
<li><a href="/hyper/de/doku/hyper-service">Übersicht</a></li>
</ul>
</li>
<li><a class="" href="#" data-toggle="collapse" data-target=
"page-channels-nav">Channels</a>
<ul class="is-hidden" id="page-channels-nav">
<li><a href="/hyper/de/doku/channels/quic">QUIC</a></li>
</ul>
</li>
<li><a class="is-active" href="#" data-toggle="collapse"
data-target="page-proxy-nav">Proxy Service</a>
<ul class="" id="page-proxy-nav">
<li><a href="/hyper/de/doku/proxy-service">Übersicht</a></li>
<li><a href=
"/hyper/de/doku/proxy-service/installation">Installation</a></li>
<li><a href=
"/hyper/de/doku/proxy-service/configuration">Konfiguration</a></li>
<li><a href="/hyper/de/doku/proxy-service/security">Sicherheit &
Bedrohungsmodell</a></li>
<li><a href="/hyper/de/doku/proxy-service/p2p">Peer-To-Peer (P2P)
Proxy</a></li>
</ul>
</li>
<li><a class="" href="#" data-toggle="collapse" data-target=
"page-sd-nav">Service Directory</a>
<ul class="is-hidden" id="page-sd-nav">
<li><a href="/hyper/de/doku/service-directory">Übersicht</a></li>
<li><a href=
"/hyper/de/doku/service-directory/installation">Installation</a></li>
<li><a href=
"/hyper/de/doku/service-directory/configuration">Konfiguration</a></li>
</ul>
</li>
<li><a href="/hyper/de/doku/kontakt">Kontakt</a></li>
<li><a href="#" data-toggle="collapse" data-target=
"menu-language-dropdown">Sprachen</a>
<ul id="menu-language-dropdown" class="is-hidden">
<li><a class="" href=
"/hyper/docs/proxy-service/security">English</a></li>
<li><a class="is-open is-active" href=
"/hyper/de/doku/proxy-service/security">Deutsch</a></li>
</ul>
</li>
</ul>
</aside>
</div>
<div class="with-comments">
<div class="comments"></div>
<section class="section first">
<div class="content">
<div class="content markdown">
<h1>Proxy Sicherheit & Bedrohungsmodell</h1>
<p>Der öffentliche Proxy wurde entwickelt, um die Kommunikation
zwischen einem Client und einem privaten Proxy-Endpunkt zu
vermitteln, ohne die TLS-Verschlüsselung zwischen diesen beiden
aufzubrechen. Er erreicht dies, indem er den TLS-Handshake
instrumentiert, insbesondere durch das Parsen des
<code>ClientHello</code> Pakets, das vom Client gesendet wird, um
die Verbindung zum privaten Proxy zu initiieren. Dieses Paket ist
in RFC-5246 [^1] beschrieben und enthält normalerweise eine
<code>ServerNameList</code> -Erweiterung, wie in RFC-6066 [^2]
beschrieben, die den Servernamen angibt, zu dem der Client eine
Verbindung herstellen möchte. HTTPs-Server verwenden diese
Informationen in der Regel, um das passende Zertifikat auszuwählen,
da ein einziger Server oft Inhalte für viele Domänen hostet. Ebenso
kann der öffentliche Proxy diese Informationen verwenden, um
festzustellen, welcher private Proxy (falls vorhanden) die
Verbindung des Clients bearbeiten kann. Er kann dann eine
TCP-Verbindung zu diesem privaten Proxy öffnen und den gesamten
TCP-Stream (einschließlich des Pakets <code>HelloClient</code> ) an
ihn weiterleiten. Auf diese Weise fungiert der öffentliche Proxy
als nicht vertrauenswürdiger Mann in der Mitte zwischen dem Client
und dem privaten Proxy und leitet verschlüsselte Daten zwischen
ihnen weiter.</p>
<h2>Bedrohungsmodell</h2>
<p>Unser Bedrohungsmodell geht davon aus, dass der öffentliche
Proxy vollständig kompromittiert werden kann. In Szenario 1 erlangt
ein Angreifer die vollständige Kontrolle über den öffentlichen
Proxy-Server und ist in der Lage, den Servercode durch seinen
eigenen Code zu ersetzen, der z.B. darauf abzielt, die zwischen dem
Client und dem privaten Proxy ausgetauschten Daten zu exfiltrieren.
In Szenario 2 gelingt es einem Angreifer, den für den öffentlichen
Proxy bestimmten Datenverkehr auf seinen eigenen Server umzuleiten,
wo er wie in Szenario 1 beliebigen Code ausführen kann, um z.B.
Daten zu exfiltrieren.</p>
<p>Beide Szenarien stellen einen Man-in-the-Middle-Angriff (MITM)
dar. Systeme, die TLS implementieren, sind so konzipiert, dass sie
solche Angriffe mit Hilfe einer Vertrauenskette, die durch eine
Public-Key-Infrastruktur bereitgestellt wird, abwehren. Unter
idealen Umständen ist es für einen MITM-Angreifer unmöglich, dem
Client ein gültiges TLS-Zertifikat vorzulegen, so dass dieser sich
weigert, eine Verbindung mit dem Server herzustellen. Mit der
Einführung des ACME-Protokolls [^3] ist es für einen Angreifer
jedoch möglich geworden, auf einfache Weise ein gültiges
TLS-Zertifikat für einen Hostnamen zu generieren, dessen
Server-Endpunkt er kontrolliert. In beiden oben genannten Szenarien
würde dies den Angreifer in die Lage versetzen, einen ACME-Anbieter
wie LetsEncrypt zu verwenden, um ein gültiges TLS-Zertifikat zu
generieren und dann die Client-Server-TLS-Verbindung ohne Wissen
des Clients oder des Servers zu beenden und zu vermitteln.</p>
<p>Um dieses Risiko zu minimieren, sollte die Ausstellung von
Zertifikaten über ACME für alle Hostnamen, die über den
öffentlichen Proxy vermittelt werden, eingeschränkt werden. Darüber
hinaus sollten <a href=
"https://developer.mozilla.org/en-US/docs/Web/Security/Certificate_Transparency">
Mechanismen zur Transparenz von Zertifikaten (CT)</a> eingesetzt
werden, die es dem Client ermöglichen, die Falschausstellung eines
Zertifikats durch einen MITM-Angreifer zu erkennen.</p>
<p>Ein unabhängiges Risiko in den Szenarien 1 und 2 ist die
Fähigkeit des Gegners, die Metadaten der verschlüsselten Verbindung
aufzuzeichnen, was ebenfalls sensible Informationen offenbaren
kann. Um dieses Risiko zu verringern, sollten Techniken zur
Verschleierung von Metadaten auf die Client-Server-Kommunikation
angewendet werden.</p>
<p>Schließlich können die Angreifer aus den Szenarien 1 und 2 auch
den Dienst für den Client und den Server verweigern, indem sie die
Kommunikation zwischen ihnen unterbrechen. Dieses Risiko lässt sich
in diesen Szenarien aufgrund der privilegierten Position der
Angreifer nicht ohne weiteres eindämmen. Denial-of-Service
(DoS)-Angriffe durch externe Angreifer können mit gängigen
Techniken abgewehrt werden, die hier nicht näher erläutert
werden.</p>
<p>[^1] : <a href=
"https://datatracker.ietf.org/doc/html/rfc5246">RFC-5264</a> [^2] :
<a href=
"https://datatracker.ietf.org/doc/html/rfc6066#section-3">RFC-6066</a>
[^3] : <a href=
"https://datatracker.ietf.org/doc/html/rfc8555">RFC-8555</a></p>
</div>
</div>
</section>
</div>
</div>
<script defer type="text/javascript" src=
"/hyper/docs/static/js/bulma.js"></script>
</body>
</html>
